设置一个excel公式，S列为15位数字，由S2至S22000，重复项在数字后添加“_1,_2,_3"，首次出现不添加后缀，重复第一次添加_1，重复第二次添加_2，以此类推，在T列得出结果

好的，这是一个可以在 Excel 中实现您需求的公式：

Excel

```
=IF(COUNTIF($S$2:S2,S2)=1,S2,S2&"_"&COUNTIF($S$2:S2,S2)-1)
```

## 公式解释

- **`IF(COUNTIF($S$2:S2,S2)=1,S2,...`**: 这是一个 IF 函数，用于检查当前行 S 列的数字是否是第一次出现。
    - **`COUNTIF($S$2:S2,S2)`**: 这个函数计算从 S2 到当前行 S 列的范围内，与当前行 S 列数字相同的单元格数量。
    - **`=1`**: 如果 COUNTIF 的结果为 1，说明当前数字是第一次出现。
    - **`S2`**: 如果是第一次出现，则直接返回 S 列的原始数字。
- **`... ,S2&"_"&COUNTIF($S$2:S2,S2)-1)`**: 这是 IF 函数的另一部分，处理重复出现的情况。
    - **`S2`**: 返回 S 列的原始数字。
    - **`&"_"&`**: 在数字后面添加下划线 "_"。
    - **`COUNTIF($S$2:S2,S2)-1`**: 计算当前数字是第几次重复出现。由于第一次出现时不添加后缀，所以要减 1。

## 如何使用

1. 将上述公式复制到 T2 单元格。
2. 将鼠标悬停在 T2 单元格的右下角，光标会变成十字形。
3. 按住鼠标左键并向下拖动，直到 T22000 单元格。

## 示例

|S 列 (原始数据)|T 列 (结果)|
|---|---|
|123456789012345|123456789012345|
|123456789012345|123456789012345_1|
|987654321098765|987654321098765|
|123456789012345|123456789012345_2|
|987654321098765|987654321098765_1|

导出到 Google 表格

## 注意事项

- 这个公式假设 S 列的数字都是 15 位。
- 如果 S 列有其他类型的数据，可能需要对公式进行调整。